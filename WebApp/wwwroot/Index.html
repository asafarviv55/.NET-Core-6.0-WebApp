<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
</head>
<body>



    <div id="app" style="margin-top:70px">
        <div class="pure-g">
            <div class="pure-u-1-5"></div>
            <div class="pure-u-3-5">
                <div>
                    <label for="searchBox">Please Type String to Search </label><br>
                    <input type="text" id="searchBox" value=""  v-on:input="search"/>
                </div>
                <table class="pure-table pure-table-striped  pure-table-bordered">
                    <thead>
                        <tr>
                            <th style="width:80px">Product Code</th>
                            <th style="width:150px">Name</th>
                            <th style="width:300px">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(row,index) in allProducts">
                            <td hidden>{{row.id}}</td>
                            <td>{{row.code}}</td>
                            <td>{{row.name}}</td>
                            <td>{{row.description}}</td>
                            <td v-on:click="editRow(row.id)">Edit</td>
                            <td v-on:click="deleteItem(row.id)">Delete</td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
                <div>
                    <input type="button" value="ADD" v-on:click="AddProduct()" />
                </div>
            </div>
            <div class="pure-u-1-5"></div>
        </div>
    </div>

    <script>
        const App = {
            mounted() {
                axios.get("api/Products/GetAllProducts")
                    .then(response => {
                        console.log("response");
                        this.allProducts = response.data;
                        this.rKey++;
                    })
            },
            data() {
                return {
                    allProducts: [],
                    rKey: 0,
                    message: "Hello Element Plus",
                    page: 1,
                    sortColumn: 'id',
                    sortDirection: 'asc',
                    filterString: '',
                    offset: 5,
                    searctStr: ''
                }
            },
            methods: {
                search(event) {
                    this.searctStr = event.target.value;
                    this.refreshData(this.searctStr);
                },
                refreshData(str) {
                    var querystr = '';
                    if (str == '')
                        querystr = "api/Products/GetAllProducts";
                    else
                        querystr = "api/Products/RefreshProducts?str=" + str;

                    axios.get(querystr)
                            .then(response => {
                                console.log("response");
                                this.allProducts = response.data;
                                this.rKey++;
                            })
                }
            }
        };
        const app = Vue.createApp(App);
        app.mount("#app");


    </script>

</body>
</html>